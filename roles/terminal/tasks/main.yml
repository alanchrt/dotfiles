---
- name: Install tilix
  become: yes
  dnf:
    name: tilix

- name: Configure tilix
  shell: "dconf load /com/gexperts/Tilix/ < {{ role_path }}/files/tilix.conf"

- name: Add dropterm command
  copy:
    src: files/dropterm
    dest: "{{ ansible_env.HOME }}/.local/bin/dropterm"
    mode: +x

- name: Install zsh
  become: yes
  dnf:
    name: zsh

- name: Configure default shell
  become: yes
  user:
    name: "{{ ansible_env.USER }}"
    shell: /usr/bin/zsh

- name: Set up oh-my-zsh
  git:
    repo: https://github.com/ohmyzsh/ohmyzsh.git
    dest: "{{ ansible_env.HOME }}/.oh-my-zsh"

- name: Clone powerlevel10k theme
  git:
    repo: https://github.com/romkatv/powerlevel10k.git
    dest: "{{ ansible_env.HOME }}/.oh-my-zsh/custom/themes/powerlevel10k"

- name: Clone zsh-users plugins
  git:
    repo: "https://github.com/zsh-users/{{ item }}.git"
    dest: "{{ ansible_env.HOME }}/.oh-my-zsh/custom/plugins/{{ item }}"
  with_items:
    - zsh-completions
    - zsh-syntax-highlighting
    - zsh-history-substring-search
